<% breadcrumb :application_education, @application %>
<% @title = 'Education' %>

<%= render partial: 'remove_modal',
           locals: {title: 'Remove School',
                    message: 'Are you sure you want to remove the following school?'} %>

<div class="row">
  <div class="col-sm-3">
    <%= render partial: 'stages_sidebar', locals: {application: @application, stage: :education} %>
  </div>

  <div class="col-sm-9">
    <div class="row">
      <div class="col-xs-12">

        <!-- Add school form -->
        <%= form_for @school, url: applications_education_add_path(@application), method: :post do |f|%>
          <h3 class="no-top-margin">Add School or Institution</h3>
          <p class="text-darkish small">Add any school, college, university, or other institution where you have gained a qualification.</p>
          <%= form_errors @school %>
          <div class="row">
            <div class="col-sm-6">
              <table class="table">
                <tr>
                  <td><%= f.label 'School Name' %></td>
                  <td><%= f.text_field :name, class: 'full-width' %></td>
                </tr>
                <tr>
                  <td><%= f.label :address_1 %></td>
                  <td><%= f.text_field :address_1, class: 'full-width' %></td>
                </tr>
                <tr>
                  <td><%= f.label :address_2 %> *</td>
                  <td><%= f.text_field :address_2, class: 'full-width' %></td>
                </tr>
              </table>
            </div> <!-- End col -->
            <div class="col-sm-6">
              <table class="table">
                <tr>
                  <td><%= f.label 'Post Code', class: 'text-capitalize' %></td>
                  <td><%= f.text_field :postcode, class: 'full-width' %></td>
                </tr>
                <tr>
                  <td><%= f.label :country %></td>
                  <td><%= f.text_field :country, class: 'full-width' %></td>
                </tr>
                <tr>
                  <td class="text-darkish small">
                      <em>* Optional</em>
                  </td>
                  <td class="text-right">
                    <%= f.submit 'Add School', class: 'add-button' %>
                  </td>
                </tr>
              </table>
            </div> <!-- End col -->
          </div> <!-- End row -->
        <% end %>

        <!-- Form used to validate that schools/courses have been added -->
        <%= form_for @application, url: applications_education_next_path(@application), method: :post do |f| %>
          <!-- Display schools list -->
          <h3 class="no-top-margin">Education History</h3>
          <%= form_errors @application %>
          <% if @application.schools.empty? %>
            <br>
            <p class="text-darkish text-center small"><em>Any school you add will appear here.</em></p>
            <br>
          <% else %>
            <p class="text-darkish small">You can add the qualifications gain at each school by selecting the add qualifications option.</p>
            <div class="list-group">
              <% @application.schools.each do |school| %>
                <div class="education-item list-group-item-heading">
                  <div class="row">
                    <div class="col-sm-6">
                      <h4 class="no-top-margin no-bottom-padding"><%= school.name %></h4>
                      <address class="small">
                        <%= school.address_1 %><br>
                        <%= school.address_2 %> <%= '<br>'.html_safe unless school.address_2.nil? or school.address_2.empty? %>
                        <%= school.country %><br>
                        <%= school.postcode %>
                      </address>
                    </div> <!-- End col -->
                    <div class="col-sm-6 text-right">
                      <div>
                      <a href="<%= url_for applications_qualifications_path(school) %>" class="add-button" role="button" >
                        <%= icon 'plus-circle', style: 'font-size: 13pt;' %>
                        &nbsp;
                        Add Qualifications
                        <% count = school.qualifications.count %>
                        <% if count > 0 %>
                            (<%= count %>)
                        <% end %>
                      </a>
                      &nbsp;
                      <a data-modal-name="<%= school.name %>"
                         data-modal-path="<%= applications_education_remove_path(school) %>"
                         class="add-button custom-modal-button"
                         role="button">
                        <%= icon 'trash', style: 'font-size: 13pt;' %>
                        &nbsp;
                        Remove
                      </a>
                      </div>
                    </div> <!-- End col -->
                  </div> <!-- End row -->
                </div> <!-- End list item -->
              <% end %>
            </div> <!-- End group -->
          <% end %>

          <div class="row">
            <div class="col-sm-12 text-right">
              <br>
              <p class="text-darkish small">When ready continue to the next section.</p>
                <%= f.submit 'Next', class: 'next-button' %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

