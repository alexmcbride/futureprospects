<%
  breadcrumb :payments
  @title = 'Payment Transactions'
%>

<% if @payments.any? %>
  <p>This pages lists all of the payment transactions on your account.</p>
  <div class="table-responsive">
    <table class="table table-striped table-condensed">
      <thead>
        <tr>
          <th>Status</th>
          <th>Type</th>
          <th>Amount</th>
          <th>Date</th>
          <th>Card Holder</th>
          <th>Card Number</th>
          <th>Invoice</th>
        </tr>
      </thead>
      <tbody>
        <% @payments.each do |payment| %>
          <tr>
            <td><%= icon(payment.authorized? ? 'check' : 'ban', style: 'width: 1em;') %> <%= payment.status.humanize %></td>
            <td><%= icon(payment.paypal? ? 'cc-paypal' : 'credit-card-alt') %> <%= payment.payment_type.humanize %></td>
            <td><%= number_to_currency payment.amount_pounds, unit: 'Â£' %></td>
            <td><%= format_date payment.created_at %></td>
            <td><%= payment.credit_card? ? payment.card_holder : 'N/A' %></td>
            <td><%= payment.credit_card? ? credit_card_number(payment.last_four_digits) : 'N/A' %></td>
            <td><%= link_to 'Download', payment_path(payment, format: :pdf) unless payment.paypal? || payment.failed? %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <div class="alert alert-info">There are no transactions to display</div>
<% end %>